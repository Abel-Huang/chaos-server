<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.abelib.tmall.dao.PropertyValueDao">
    <resultMap id="propertyValueMap" type="PropertyValue">
        <id property="id" column="id"/>
        <result property="productId" column="pid"/>
        <result property="propertyId"  column="ptid"/>
        <result property="propertyValue" column="property_value"/>
    </resultMap>
    <cache/>
    <!--遍历整个 property_value 表-->
    <select id="listAllPropertyValue" resultMap="propertyValueMap">
        select * from property_value
        <where>
            <if test="_parameter != null ">
                pid = #{_parameter}
            </if>
        </where>
    </select>

    <!--通过id获取 propertyValue-->
    <select id="getPropertyValueById" parameterType="int" resultMap="propertyValueMap">
        select * from property_value
        where pid = #{id}
    </select>

    <!--插入，并且主键回填-->
    <insert id="insertPropertyValue"  parameterType="PropertyValue"
            useGeneratedKeys="true"  keyProperty="id">
        insert into property_value(pid, ptid, property_value) values(#{productId}, #{propertyId}, #{propertyValue})
    </insert>

    <!--删除 propertyValue-->
    <delete id="deletePropertyValue" parameterType="int">
        delete from property_value where id = #{id}
    </delete>

    <!--更新 propertyValue-->
    <update id="updatePropertyValue" parameterType="PropertyValue">
        update property_value
        <set>
            <if test="propertyValue != null and propertyValue != ''">
                property_value = #{propertyValue},
            </if>
            <if test="productId != null">
                pid = #{productId},
            </if>
            <if test="propertyId != null">
                ptid = #{propertyId}
            </if>
        </set>
        where id = #{id}
    </update>
</mapper>